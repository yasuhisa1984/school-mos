!function(a){var e,t={title:"Are you sure?",commit:"Confirm",commitClass:"btn-danger",cancel:"Cancel",cancelClass:"btn-default",fade:!0,verifyClass:"form-control",elements:["a[data-confirm]","button[data-confirm]","input[type=submit][data-confirm]"],focus:"commit",zIndex:1050,modalClass:!1,show:!0};if(window.dataConfirmModal={setDefaults:function(t){e=a.extend(e,t)},restoreDefaults:function(){e=a.extend({},t)},confirm:function(a){var e=r(a);e.spawn(),e.on("hidden.bs.modal",function(){e.remove()}),e.find(".commit").on("click",function(){a.onConfirm&&a.onConfirm.call&&a.onConfirm.call(),e.modal("hide")}),e.find(".cancel").on("click",function(){a.onCancel&&a.onCancel.call&&a.onCancel.call(),e.modal("hide")})}},dataConfirmModal.restoreDefaults(),a.fn.modal==undefined)throw new Error("The bootstrap modal plugin does not appear to be loaded.");if(a.fn.modal.Constructor==undefined)throw new Error("The bootstrap modal plugin does not have a Constructor ?!?");if(a.fn.modal.Constructor.VERSION==undefined)throw new Error("The bootstrap modal plugin does not have its version defined ?!?");var o=a.fn.modal.Constructor.VERSION,n=o.match(/^(\d)\./);if(!n)throw new Error("Cannot identify Bootstrap version. Version string: "+o);var i=parseInt(n[1]);if(3!=i&&4!=i)throw new Error("Unsupported bootstrap version: "+i+". data-confirm-modal supports version 3 and 4.");var d=function(a){var e={title:a.data("title")||a.attr("title")||a.data("original-title"),text:a.data("confirm"),focus:a.data("focus"),method:a.data("method"),modalClass:a.data("modal-class"),commit:a.data("commit"),commitClass:a.data("commit-class"),cancel:a.data("cancel"),cancelClass:a.data("cancel-class"),remote:a.data("remote"),verify:a.data("verify"),verifyRegexp:a.data("verify-regexp"),verifyLabel:a.data("verify-text"),verifyRegexpCaseInsensitive:a.data("verify-regexp-caseinsensitive"),backdrop:a.data("backdrop"),keyboard:a.data("keyboard"),show:a.data("show")},t=r(e);return t.find(".commit").on("click",function(){a.get(0).click(),t.modal("hide")}),t},r=function(t){var o,n="confirm-modal-"+String(Math.random()).slice(2,-1),d=e.fade?"fade":"",r=t.modalClass?t.modalClass:e.modalClass,s='<h5 id="'+n+'Label" class="modal-title"></h5> ',l='<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>';switch(i){case 3:o=l+s;break;case 4:o=s+l}var c=a('<div id="'+n+'" class="modal '+r+" "+d+'" tabindex="-1" role="dialog" aria-labelledby="'+n+'Label" aria-hidden="true"><div class="modal-dialog" role="document"><div class="modal-content"><div class="modal-header">'+o+'</div><div class="modal-body"></div><div class="modal-footer"><button class="btn cancel" data-dismiss="modal" aria-hidden="true"></button><button class="btn commit"></button></div></div></div></div>'),m=current=e.zIndex;a(".modal.in").not("#"+n).each(function(){current=parseInt(a(this).css("z-index"),10),current>m&&(m=current)}),c.css("z-index",parseInt(m)+1),c.find(".modal-title").text(t.title||e.title);var f=c.find(".modal-body");a.each((t.text||"").split(/\n{2}/),function(e,t){f.append(a("<p/>").html(t))});var u=c.find(".commit");u.text(t.commit||e.commit),u.addClass(t.commitClass||e.commitClass);var v=c.find(".cancel");if(v.text(t.cancel||e.cancel),v.addClass(t.cancelClass||e.cancelClass),t.remote&&u.attr("data-dismiss","modal"),t.verify||t.verifyRegexp){u.prop("disabled",!0);var p;if(t.verifyRegexp){var b=t.verifyRegexpCaseInsensitive,h=t.verifyRegexp,y=new RegExp(h,b?"i":"");p=function(a){return a.match(y)}}else p=function(a){return t.verify==a};var C=a("<input/>",{type:"text","class":e.verifyClass}).on("keyup",function(){u.prop("disabled",!p(a(this).val()))});c.on("shown.bs.modal",function(){C.focus()}),c.on("hidden.bs.modal",function(){C.val("").trigger("keyup")}),t.verifyLabel&&f.append(a("<p>",{text:t.verifyLabel})),f.append(C)}var w;return w=t.focus?t.focus:"delete"==t.method?"cancel":e.focus,w=c.find("."+w),c.on("shown.bs.modal",function(){w.focus()}),a("body").append(c),c.spawn=function(){return c.modal({backdrop:t.backdrop,keyboard:t.keyboard,show:t.show})},c},s=function(a){var e=a.data("confirm-modal");return e||(e=d(a),a.data("confirm-modal",e)),e};if(a.fn.confirmModal=function(){var e=s(a(this));return e.spawn(),e},a.rails){var l=window.confirm;a(document).delegate(e.elements.join(", "),"confirm",function(){var e=a(this),t=s(e);return t.is(":visible")?(window.confirm=function(){return!0},t.one("hidden.bs.modal",function(){window.confirm=l}),!0):(t.spawn(),!1)})}}(jQuery);