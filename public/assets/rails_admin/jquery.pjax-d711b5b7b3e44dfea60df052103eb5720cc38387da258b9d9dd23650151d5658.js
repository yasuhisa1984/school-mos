!function(u){function t(t,a,n){var r=this;return this.on("click.pjax",t,function(t){var e=u.extend({},i(a,n));e.container||(e.container=u(this).attr("data-pjax")||r),o(t,e)})}function o(t,e,a){a=i(e,a);var n=t.currentTarget;if("A"!==n.tagName.toUpperCase())throw"$.fn.pjax or $.pjax.click requires an anchor element";if(!(1<t.which||t.metaKey||t.ctrlKey||t.shiftKey||t.altKey||location.protocol!==n.protocol||location.host!==n.host||n.hash&&n.href.replace(n.hash,"")===location.href.replace(location.hash,"")||n.href===location.href+"#")){var r={url:n.href,container:u(n).attr("data-pjax"),target:n,fragment:null};p(u.extend({},r,a)),t.preventDefault()}}function e(t,e,a){a=i(e,a);var n=t.currentTarget;if("FORM"!==n.tagName.toUpperCase())throw"$.pjax.submit requires a form element";var r={type:n.method,url:n.action,data:u(n).serializeArray(),container:u(n).attr("data-pjax"),target:n,fragment:null};p(u.extend({},r,a)),t.preventDefault()}function p(i){function l(t,e){var a=u.Event(t,{relatedTarget:n});return s.trigger(a,e),!a.isDefaultPrevented()}i=u.extend(!0,{},u.ajaxSettings,p.defaults,i),u.isFunction(i.url)&&(i.url=i.url());var a,t,n=i.target,c=m(i.url).hash,s=i.context=x(i.container);return i.data||(i.data={}),i.data._pjax=s.selector,i.beforeSend=function(t,e){if("GET"!==e.type&&(e.timeout=0),t.setRequestHeader("X-PJAX","true"),t.setRequestHeader("X-PJAX-Container",s.selector),!l("pjax:beforeSend",[t,e]))return!1;0<e.timeout&&(a=setTimeout(function(){l("pjax:timeout",[t,i])&&t.abort("timeout")},e.timeout),e.timeout=0),i.requestUrl=m(e.url).href},i.complete=function(t,e){a&&clearTimeout(a),l("pjax:complete",[t,e,i]),l("pjax:end",[t,i])},i.error=function(t,e,a){var n=g("",t,i),r=l("pjax:error",[t,e,a,i]);"GET"==i.type&&"abort"!==e&&r&&d(n.url)},i.success=function(t,e,a){var n=g(t,a,i);if(n.contents){if(p.state={id:i.id||f(),url:n.url,title:n.title,container:s.selector,fragment:i.fragment,timeout:i.timeout},(i.push||i.replace)&&window.history.replaceState(p.state,n.title,n.url),n.title&&(document.title=n.title),s.html(n.contents),"number"==typeof i.scrollTo&&u(window).scrollTop(i.scrollTo),(i.replace||i.push)&&window._gaq&&_gaq.push(["_trackPageview"]),""!==c){var r=m(n.url);r.hash=c,p.state.url=r.href,window.history.replaceState(p.state,n.title,r.href);var o=u(r.hash);o.length&&u(window).scrollTop(o.offset().top)}l("pjax:success",[t,e,a,i])}else d(n.url)},p.state||(p.state={id:f(),url:window.location.href,title:document.title,container:s.selector,fragment:i.fragment,timeout:i.timeout},window.history.replaceState(p.state,document.title)),(t=p.xhr)&&t.readyState<4&&(t.onreadystatechange=u.noop,t.abort()),p.options=i,0<(t=p.xhr=u.ajax(i)).readyState&&(i.push&&!i.replace&&(j(p.state.id,s.clone().contents()),window.history.pushState(null,"",h(i.requestUrl))),l("pjax:start",[t,i]),l("pjax:send",[t,i])),p.xhr}function a(t,e){var a={url:window.location.href,push:!1,replace:!0,scrollTo:!1};return p(u.extend(a,i(t,e)))}function d(t){window.history.replaceState(null,"","#"),window.location.replace(t)}function n(t){var e=t.state;if(e&&e.container){var a=u(e.container);if(a.length){var n=v[e.id];if(!p.state)return void(p.state=e);var r=p.state.id<e.id?"forward":"back";c(r,p.state.id,a.clone().contents());var o=u.Event("pjax:popstate",{state:e,direction:r});a.trigger(o);var i={id:e.id,url:e.url,container:a,push:!1,fragment:e.fragment,timeout:e.timeout,scrollTo:!1};n?(a.trigger("pjax:start",[null,i]),e.title&&(document.title=e.title),a.html(n),p.state=e,a.trigger("pjax:end",[null,i])):p(i),a[0].offsetHeight}else d(location.href)}}function r(t){var e=u.isFunction(t.url)?t.url():t.url,a=t.type?t.type.toUpperCase():"GET",n=u("<form>",{method:"GET"===a?"GET":"POST",action:e,style:"display:none"});"GET"!==a&&"POST"!==a&&n.append(u("<input>",{type:"hidden",name:"_method",value:a.toLowerCase()}));var r=t.data;if("string"==typeof r)u.each(r.split("&"),function(t,e){var a=e.split("=");n.append(u("<input>",{type:"hidden",name:a[0],value:a[1]}))});else if("object"==typeof r)for(key in r)n.append(u("<input>",{type:"hidden",name:key,value:r[key]}));u(document.body).append(n),n.submit()}function f(){return(new Date).getTime()}function h(t){return t.replace(/\?_pjax=[^&]+&?/,"?").replace(/_pjax=[^&]+&?/,"").replace(/[\?&]$/,"")}function m(t){var e=document.createElement("a");return e.href=t,e}function i(t,e){return t&&e?e.container=t:e=u.isPlainObject(t)?t:{container:t},e.container&&(e.container=x(e.container)),e}function x(t){if((t=u(t)).length){if(""!==t.selector&&t.context===document)return t;if(t.attr("id"))return u("#"+t.attr("id"));throw"cant get selector for pjax container!"}throw"no pjax container for "+t.selector}function l(t,e){return t.filter(e).add(t.find(e))}function g(t,e,a){var n={};if(n.url=h(e.getResponseHeader("X-PJAX-URL")||a.requestUrl),/<html/i.test(t))var r=u(t.match(/<head[^>]*>([\s\S.]*)<\/head>/i)[0]),o=u(t.match(/<body[^>]*>([\s\S.]*)<\/body>/i)[0]);else r=o=u(t);if(0===o.length)return n;if(n.title=l(r,"title").last().text(),a.fragment){if("body"===a.fragment)var i=o;else i=l(o,a.fragment).first();i.length&&(n.contents=i.contents(),n.title||(n.title=i.attr("title")||i.data("title")))}else/<html/i.test(t)||(n.contents=o);return n.contents&&(n.contents=n.contents.not("title"),n.contents.find("title").remove()),n.title&&(n.title=u.trim(n.title)),n}function j(t,e){for(v[t]=e,b.push(t);y.length;)delete v[y.shift()];for(;b.length>p.defaults.maxCacheLength;)delete v[b.shift()]}function c(t,e,a){var n,r;v[e]=a,"forward"===t?(n=b,r=y):(n=y,r=b),n.push(e),(e=r.pop())&&delete v[e]}function s(){u.fn.pjax=t,u.pjax=p,u.pjax.enable=u.noop,u.pjax.disable=w,u.pjax.click=o,u.pjax.submit=e,u.pjax.reload=a,u.pjax.defaults={timeout:650,push:!0,replace:!1,type:"GET",dataType:"html",scrollTo:0,maxCacheLength:20},u(window).bind("popstate.pjax",n)}function w(){u.fn.pjax=function(){return this},u.pjax=r,u.pjax.enable=s,u.pjax.disable=u.noop,u.pjax.click=u.noop,u.pjax.submit=u.noop,u.pjax.reload=function(){window.location.reload()},u(window).unbind("popstate.pjax",n)}var v={},y=[],b=[];u.inArray("state",u.event.props)<0&&u.event.props.push("state"),u.support.pjax=window.history&&window.history.pushState&&window.history.replaceState&&!navigator.userAgent.match(/((iPod|iPhone|iPad).+\bOS\s+[1-4]|WebApps\/.+CFNetwork)/),u.support.pjax?s():w()}(jQuery);